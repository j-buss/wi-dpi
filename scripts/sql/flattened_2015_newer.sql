SELECT
  master_data.year,
  master_data.key,
  master_data.max_first_name,
  master_data.max_last_name,
  master_data.max_gender,
  master_data.max_race_ethnicity_cd,
  master_data.max_birth_year,
  master_data.max_contract_high_degree_cd,
  master_data.max_contract_local_experience,
  master_data.max_contract_total_experience,
  master_data.max_contract_days,
  master_data.teacher_cnt,
  master_data.admin_cnt,
  master_data.other_cnt,
  master_data.rec_cnt,
  master_data.assignment_fte,
  master_data.salary_cnt,
  master_data.null_salary_cnt,
  master_data.contract_cnt,
  master_data.max_salary,
  master_data.max_benefits,
  dtl_data.first_name,
  dtl_data.last_name,
  dtl_data.gender,
  dtl_data.race_ethnicity_cd,
  dtl_data.race_ethnicity_desc,
  dtl_data.birth_year,
  dtl_data.high_degree_cd,
  dtl_data.high_degree_desc,
  dtl_data.contract_days,
  dtl_data.local_exp,
  dtl_data.total_exp,
  dtl_data.salary,
  dtl_data.salary_nominal,
  dtl_data.benefits,
  dtl_data.benefits_nominal,
  dtl_data.hire_agency_type_cd,
  dtl_data.hire_agency_type_desc,
  dtl_data.work_agency_type_cd,
  dtl_data.work_agency_type_desc,
  dtl_data.hire_agency_cd,
  dtl_data.hire_agency_desc,
  dtl_data.work_agency_cd,
  dtl_data.work_agency_desc,
  dtl_data.school_cd,
  dtl_data.school_name,
  dtl_data.assignment_area_cd,
  dtl_data.assignment_area_description,
  dtl_data.low_grade,
  dtl_data.high_grade,
  dtl_data.bilingual,
  dtl_data.assignment_fte,
  dtl_data.school_level_cd,
  dtl_data.school_level_desc,
  dtl_data.cesa_num,
  dtl_data.county_num,
  dtl_data.county_name,
  dtl_data.school_mailing_address1,
  dtl_data.mail_city,
  dtl_data.mail_st,
  dtl_data.mail_zip_cd,
  dtl_data.long_term_sub,
  dtl_data.sub_contracted
FROM
  `wi-dpi-010.Merged.detail_2015` AS dtl_data
LEFT JOIN `wi-dpi-010.Merged.master_data_2015_newer` AS master_data
ON (dtl_data.key = master_data.key AND dtl_data.year = master_data.year)
